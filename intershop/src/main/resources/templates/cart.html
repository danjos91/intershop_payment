<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <title>–ö–æ—Ä–∑–∏–Ω–∞ —Ç–æ–≤–∞—Ä–æ–≤</title>
</head>

<body>
    <div style="float:right; margin-top: 10px;">
        <a href="/orders" style="text-decoration:none;">
            <button style="background-color:#4CAF50;color:white;padding:10px 20px;margin-right:10px;border:none;border-radius:5px;cursor:pointer;font-size:16px;">
                &#128179; –ó–ê–ö–ê–ó–´
            </button>
        </a>
        <a href="/main/items" style="text-decoration:none;">
            <button style="background-color:#FF9800;color:white;padding:10px 20px;border:none;border-radius:5px;cursor:pointer;font-size:16px;">
                &#127968; –ì–õ–ê–í–ù–ê–Ø
            </button>
        </a>
    </div>
    <table style="width:70%;margin-left:auto;margin-right:auto;">
        <tr th:each="item : ${items}">
            <td>
                <table>
                    <tr>
                        <td>
                            <img width="300" height="300" th:src="${'http://localhost:8080/'+item.imgPath}">
                        </td>
                    </tr>
                    <tr>
                        <td>
                            <b th:text="${item.title}"></b>
                        </td>
                        <td>
                            <b th:text="${item.price}+' —Ä—É–±.'"></b>
                        </td>
                    </tr>
                    <tr><td th:text="${item.description}"></td></tr>
                    <tr>
                        <td>
                            <form th:action="${'/cart/items/'+item.id}" method="get">
                                <button name="action" value="minus">-</button>
                                <span th:text="${item.count}"></span>
                                <button name="action" value="plus">+</button>
                                <button name="action" value="delete" style="float:right;">&cross;</button>
                            </form>
                        </td>
                    </tr>
                </table>
            </td>
        </tr>
        <tr>
            <td style="text-align:right">
                <div style="margin-bottom: 10px;">
                    <b th:text="'–ò—Ç–æ–≥–æ: '+${total}+' —Ä—É–±.'"></b>
                </div>
                <div style="margin-bottom: 10px; color: #666;">
                    <span th:text="'–î–æ—Å—Ç—É–ø–Ω—ã–π –±–∞–ª–∞–Ω—Å: '+${balance}+' —Ä—É–±.'"></span>
                </div>
            </td>
        </tr>
        <tr>
            <td style="text-align:right">
                <div th:if="${param.paymentFailed != null}" style="color: red; margin-bottom: 10px; padding: 10px; background-color: #ffebee; border: 1px solid #f44336; border-radius: 4px;">
                    ‚ùå –û—à–∏–±–∫–∞ –ø–ª–∞—Ç–µ–∂–∞. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤ –∏–ª–∏ —Å–µ—Ä–≤–∏—Å –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω.
                    <div th:if="${param.error != null}" style="margin-top: 5px; font-size: 12px; color: #666;">
                        <strong>–î–µ—Ç–∞–ª–∏:</strong> <span th:text="${param.error}"></span>
                    </div>
                </div>
                <div th:if="${param.success != null}" style="color: green; margin-bottom: 10px; padding: 10px; background-color: #e8f5e8; border: 1px solid #4caf50; border-radius: 4px;">
                    ‚úÖ –ó–∞–∫–∞–∑ —É—Å–ø–µ—à–Ω–æ –æ—Ñ–æ—Ä–º–ª–µ–Ω!
                </div>
                <div th:if="${param.error != null}" style="color: red; margin-bottom: 10px; padding: 10px; background-color: #ffebee; border: 1px solid #f44336; border-radius: 4px;">
                    ‚ùå –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∑–∞–∫–∞–∑–∞.
                </div>
                <form action="/buy" method="post" th:if="${!empty}">
                    <button th:disabled="${!checkoutEnabled}" 
                            th:style="${!checkoutEnabled} ? 'background-color: #ccc; cursor: not-allowed;' : 'background-color: #4CAF50; color: white; padding: 10px 20px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px;'">
                        <span th:if="${checkoutEnabled}">üí≥ –ö—É–ø–∏—Ç—å</span>
                        <span th:unless="${checkoutEnabled}">‚ùå –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —Å—Ä–µ–¥—Å—Ç–≤</span>
                    </button>
                </form>
                <div th:if="${insufficientFunds}" style="color: orange; margin-top: 10px; padding: 10px; background-color: #fff3e0; border: 1px solid #ff9800; border-radius: 4px; font-size: 14px;">
                    üí° –î–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –ø–æ–ø–æ–ª–Ω–∏—Ç—å —Å—á–µ—Ç –Ω–∞ 
                    <b th:text="${total - balance}"></b> —Ä—É–±.
                </div>
            </td>
        </tr>
    </table>
</body>

</html>